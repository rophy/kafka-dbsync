-- Create comprehensive data type test table for Debezium 2.x vs 3.x comparison
-- Run as: sqlplus sys/oracle@localhost:1521/XEPDB1 as sysdba

SET ECHO OFF
SET FEEDBACK OFF
WHENEVER SQLERROR CONTINUE

-- Drop table if exists
BEGIN
  EXECUTE IMMEDIATE 'DROP TABLE DEMO.DATATYPE_TEST';
EXCEPTION
  WHEN OTHERS THEN NULL;
END;
/

-- Create comprehensive data type test table
CREATE TABLE DEMO.DATATYPE_TEST (
    ID NUMBER(10) NOT NULL PRIMARY KEY,
    COL_NUMBER NUMBER,
    COL_NUMBER_5 NUMBER(5),
    COL_NUMBER_10 NUMBER(10),
    COL_NUMBER_19 NUMBER(19),
    COL_NUMBER_38 NUMBER(38),
    COL_NUMBER_10_2 NUMBER(10,2),
    COL_NUMBER_15_5 NUMBER(15,5),
    COL_FLOAT FLOAT,
    COL_BINARY_FLOAT BINARY_FLOAT,
    COL_BINARY_DOUBLE BINARY_DOUBLE,
    COL_CHAR CHAR(10),
    COL_CHAR_50 CHAR(50),
    COL_VARCHAR2_50 VARCHAR2(50),
    COL_VARCHAR2_500 VARCHAR2(500),
    COL_VARCHAR2_4000 VARCHAR2(4000),
    COL_NCHAR NCHAR(10),
    COL_NVARCHAR2 NVARCHAR2(100),
    COL_DATE DATE,
    COL_TIMESTAMP TIMESTAMP,
    COL_TIMESTAMP_3 TIMESTAMP(3),
    COL_TIMESTAMP_6 TIMESTAMP(6),
    COL_TIMESTAMP_9 TIMESTAMP(9),
    COL_TIMESTAMP_TZ TIMESTAMP WITH TIME ZONE,
    COL_TIMESTAMP_LTZ TIMESTAMP WITH LOCAL TIME ZONE,
    COL_INTERVAL_YM INTERVAL YEAR TO MONTH,
    COL_INTERVAL_DS INTERVAL DAY TO SECOND,
    COL_CLOB CLOB,
    COL_NCLOB NCLOB,
    COL_BLOB BLOB,
    COL_RAW RAW(100),
    COL_BOOLEAN_SIM NUMBER(1) CHECK (COL_BOOLEAN_SIM IN (0, 1))
);

-- Enable supplemental logging on table
ALTER TABLE DEMO.DATATYPE_TEST ADD SUPPLEMENTAL LOG DATA (ALL) COLUMNS;

-- Insert test data row 1 - typical values
INSERT INTO DEMO.DATATYPE_TEST (
    ID, COL_NUMBER, COL_NUMBER_5, COL_NUMBER_10, COL_NUMBER_19, COL_NUMBER_38,
    COL_NUMBER_10_2, COL_NUMBER_15_5, COL_FLOAT, COL_BINARY_FLOAT, COL_BINARY_DOUBLE,
    COL_CHAR, COL_CHAR_50, COL_VARCHAR2_50, COL_VARCHAR2_500, COL_VARCHAR2_4000,
    COL_NCHAR, COL_NVARCHAR2,
    COL_DATE, COL_TIMESTAMP, COL_TIMESTAMP_3, COL_TIMESTAMP_6, COL_TIMESTAMP_9,
    COL_TIMESTAMP_TZ, COL_TIMESTAMP_LTZ,
    COL_INTERVAL_YM, COL_INTERVAL_DS,
    COL_CLOB, COL_NCLOB, COL_BLOB, COL_RAW, COL_BOOLEAN_SIM
) VALUES (
    1,
    123456.789, 12345, 1234567890, 1234567890123456789, 12345678901234567890123456789012345678,
    12345678.90, 1234567890.12345, 3.14159, 3.14159, 3.141592653589793,
    'CHAR10', 'Character data with padding', 'VARCHAR2 short', 'VARCHAR2 medium length text', 'VARCHAR2 longer text content here',
    N'NCHAR', N'Unicode text',
    TO_DATE('2025-06-15', 'YYYY-MM-DD'),
    TO_TIMESTAMP('2025-06-15 14:30:45.123456', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('2025-06-15 14:30:45.123', 'YYYY-MM-DD HH24:MI:SS.FF3'),
    TO_TIMESTAMP('2025-06-15 14:30:45.123456', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('2025-06-15 14:30:45.123456789', 'YYYY-MM-DD HH24:MI:SS.FF9'),
    TO_TIMESTAMP_TZ('2025-06-15 14:30:45.123456 +09:00', 'YYYY-MM-DD HH24:MI:SS.FF6 TZH:TZM'),
    TO_TIMESTAMP('2025-06-15 14:30:45.123456', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    INTERVAL '5-3' YEAR TO MONTH,
    INTERVAL '10 05:30:15.123456' DAY TO SECOND,
    'This is a CLOB test content.',
    N'This is NCLOB with Unicode',
    UTL_RAW.CAST_TO_RAW('Binary BLOB data'),
    UTL_RAW.CAST_TO_RAW('Raw binary'),
    1
);

-- Insert test data row 2 - negative values
INSERT INTO DEMO.DATATYPE_TEST (
    ID, COL_NUMBER, COL_NUMBER_5, COL_NUMBER_10, COL_NUMBER_19, COL_NUMBER_38,
    COL_NUMBER_10_2, COL_NUMBER_15_5, COL_FLOAT, COL_BINARY_FLOAT, COL_BINARY_DOUBLE,
    COL_CHAR, COL_CHAR_50, COL_VARCHAR2_50, COL_VARCHAR2_500, COL_VARCHAR2_4000,
    COL_NCHAR, COL_NVARCHAR2,
    COL_DATE, COL_TIMESTAMP, COL_TIMESTAMP_3, COL_TIMESTAMP_6, COL_TIMESTAMP_9,
    COL_TIMESTAMP_TZ, COL_TIMESTAMP_LTZ,
    COL_INTERVAL_YM, COL_INTERVAL_DS,
    COL_CLOB, COL_NCLOB, COL_BLOB, COL_RAW, COL_BOOLEAN_SIM
) VALUES (
    2,
    -999999.999, -99999, -2147483648, -9223372036854775808, -99999999999999999999999999999999999999,
    -99999999.99, -9999999999.99999, -3.14159, -3.14159, -3.141592653589793,
    'NEG', 'Negative test values', 'Negative', 'Edge case negative numbers', 'Testing negative handling',
    N'NEG', N'Negative test',
    TO_DATE('1970-01-01', 'YYYY-MM-DD'),
    TO_TIMESTAMP('1970-01-01 00:00:00.000001', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('1970-01-01 00:00:00.001', 'YYYY-MM-DD HH24:MI:SS.FF3'),
    TO_TIMESTAMP('1970-01-01 00:00:00.000001', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('1970-01-01 00:00:00.000000001', 'YYYY-MM-DD HH24:MI:SS.FF9'),
    TO_TIMESTAMP_TZ('1970-01-01 00:00:00.000001 -12:00', 'YYYY-MM-DD HH24:MI:SS.FF6 TZH:TZM'),
    TO_TIMESTAMP('1970-01-01 00:00:00.000001', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    INTERVAL '-99-11' YEAR TO MONTH,
    INTERVAL '-99 23:59:59.999999' DAY TO SECOND,
    'CLOB negative test',
    N'NCLOB negative',
    UTL_RAW.CAST_TO_RAW('Negative BLOB'),
    UTL_RAW.CAST_TO_RAW('NegRaw'),
    0
);

-- Insert test data row 3 - NULL values
INSERT INTO DEMO.DATATYPE_TEST (ID) VALUES (3);

-- Insert test data row 4 - zero values
INSERT INTO DEMO.DATATYPE_TEST (
    ID, COL_NUMBER, COL_NUMBER_5, COL_NUMBER_10, COL_NUMBER_19, COL_NUMBER_38,
    COL_NUMBER_10_2, COL_NUMBER_15_5, COL_FLOAT, COL_BINARY_FLOAT, COL_BINARY_DOUBLE,
    COL_CHAR, COL_CHAR_50, COL_VARCHAR2_50, COL_VARCHAR2_500, COL_VARCHAR2_4000,
    COL_NCHAR, COL_NVARCHAR2,
    COL_DATE, COL_TIMESTAMP, COL_TIMESTAMP_3, COL_TIMESTAMP_6, COL_TIMESTAMP_9,
    COL_TIMESTAMP_TZ, COL_TIMESTAMP_LTZ,
    COL_INTERVAL_YM, COL_INTERVAL_DS,
    COL_CLOB, COL_NCLOB, COL_BLOB, COL_RAW, COL_BOOLEAN_SIM
) VALUES (
    4,
    0, 0, 0, 0, 0,
    0.00, 0.00000, 0, 0, 0,
    ' ', ' ', '', '', '',
    N' ', N'',
    TO_DATE('2000-01-01', 'YYYY-MM-DD'),
    TO_TIMESTAMP('2000-01-01 00:00:00.000000', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('2000-01-01 00:00:00.000', 'YYYY-MM-DD HH24:MI:SS.FF3'),
    TO_TIMESTAMP('2000-01-01 00:00:00.000000', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    TO_TIMESTAMP('2000-01-01 00:00:00.000000000', 'YYYY-MM-DD HH24:MI:SS.FF9'),
    TO_TIMESTAMP_TZ('2000-01-01 00:00:00.000000 +00:00', 'YYYY-MM-DD HH24:MI:SS.FF6 TZH:TZM'),
    TO_TIMESTAMP('2000-01-01 00:00:00.000000', 'YYYY-MM-DD HH24:MI:SS.FF6'),
    INTERVAL '0-0' YEAR TO MONTH,
    INTERVAL '0 00:00:00.000000' DAY TO SECOND,
    '',
    N'',
    EMPTY_BLOB(),
    UTL_RAW.CAST_TO_RAW(''),
    0
);

COMMIT;

-- Verify
SELECT COUNT(*) AS ROW_COUNT FROM DEMO.DATATYPE_TEST;

EXIT;
